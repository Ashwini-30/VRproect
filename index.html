<!doctype html>
<html lang="en">
<head>
 <meta charset="utf-8" />
 <title>IITM MEMS Lab ‚Äî Clean VR Controls</title>
 <meta name="viewport" content="width=device-width, initial-scale=1" />

 <!-- AFRAME -->
 <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

 <style>
  html,body{margin:0;height:100%;background:#000;font-family:Poppins;}
  #fade{position:absolute;inset:0;background:#000;opacity:0;z-index:9;transition:.4s}
  #fade.on{opacity:1;}

  /* UI SAME AS YOUR ORIGINAL */
  #audioUI{position:fixed;top:16px;right:16px;display:flex;gap:12px;z-index:999;}
  .audioBtn{width:64;height:64;border-radius:18px;background:#000a;border:2px solid #00eaff;
            display:flex;align-items:center;justify-content:center;cursor:pointer;}
  .audioBtn img{width:75%;pointer-events:none;}

  #subtitles{position:fixed;bottom:60px;left:50%;transform:translateX(-50%);
             padding:10 22;background:#000c;border:1px solid #00eaff;color:#fff;
             font-size:18px;display:none;z-index:999;}
  #progressWrap{position:fixed;bottom:32px;left:50%;transform:translateX(-50%);
                width:60%;height:6px;border-radius:20px;background:#fff3;z-index:999;display:none;}
  #progressBar{width:0;height:100%;background:#00eaff;}

  #ppeUI{position:fixed;top:90px;left:16px;z-index:999;}
  #ppeToggle{padding:10 16;background:#000b;color:#ffd770;border:1px solid #ffb300;border-radius:8px;}
  #ppePanel{width:260;padding:10;background:#000d;border:1px solid #ffb300;border-radius:14px;
            color:#fff;font-size:14px;display:none;}
  #ppeGrid{display:grid;grid-template-columns:repeat(5,1fr);gap:6;margin-top:6px;}
  .ppe-item{width:44;height:44;border-radius:10px;cursor:pointer;background:#fff1}
  .ppe-item img{width:90%;}

 </style>
</head>

<body>

<!-- UI stays exactly like yours -->
<div id="fade"></div>

<div id="audioUI">
 <button id="btnAudioPlay" class="audioBtn"><img src="Images/start.png"></button>
 <button id="btnAudioStop" class="audioBtn"><img src="Images/stop.png"></button>
 <button id="btnAudioReplay" class="audioBtn"><img src="Images/replay.png"></button>
</div>

<div id="subtitles"></div>
<div id="progressWrap"><div id="progressBar"></div></div>

<div id="ppeUI">
 <button id="ppeToggle">Cleanroom PPE Test</button>
 <div id="ppePanel">
  <div id="ppeMsg">Tap ‚ÄúCleanroom PPE Test‚Äù to begin.</div>
  <div id="ppeGrid">
   <div class="ppe-item" data-id="ppe1"><img src="Images/ppe_labcoat.png"></div>
   <div class="ppe-item" data-id="ppe2"><img src="Images/ppe_shoe.png"></div>
   <div class="ppe-item" data-id="ppe3"><img src="Images/ppe_hairnet.png"></div>
   <div class="ppe-item" data-id="ppe4"><img src="Images/ppe_mask.png"></div>
   <div class="ppe-item" data-id="ppe5"><img src="Images/ppe_goggle.png"></div>
   <div class="ppe-item" data-id="ppe6"><img src="Images/ppe_gown.png"></div>
   <div class="ppe-item" data-id="ppe7"><img src="Images/ppe_shoecover.png"></div>
   <div class="ppe-item" data-id="ppe8"><img src="Images/ppe_boot.png"></div>
   <div class="ppe-item" data-id="ppe9"><img src="Images/ppe_purpleglove.png"></div>
   <div class="ppe-item" data-id="ppe10"><img src="Images/ppe_glove_blue.png"></div>
  </div>
 </div>
</div>


<!-- ============================================================================================ -->
<!--                                       VR SCENE                                              -->
<!-- ============================================================================================ -->

<a-scene vr-mode-ui="enabled:true" embedded renderer="antialias:true">

 <!-- 360 IMAGE -->
 <a-sky id="sky" radius="500" rotation="0 -90 0"></a-sky>

 <!-- Camera + Desktop Mouse Ray -->
 <a-entity id="cameraRig">
  <a-entity id="camera" camera look-controls position="0 1.6 0">
   <a-entity id="cursor"
     cursor="rayOrigin:mouse"
     raycaster="objects:.clickable"
     geometry="primitive:ring;radiusInner:0.02;radiusOuter:0.03"
     material="color:#fff">
   </a-entity>
  </a-entity>
 </a-entity>

 <!-- üî• QUEST CONTROLLER CLICK SUPPORT -->
 <a-entity id="rightHand"
   laser-controls="hand:right"
   raycaster="objects:.clickable;far:12;showLine:true">
 </a-entity>

 <a-entity id="leftHand"
   laser-controls="hand:left"
   raycaster="objects:.clickable;far:12;showLine:true">
 </a-entity>

 <!-- NAV BUTTON PLANES (same) -->
 <a-entity id="navPanel" position="0 0.22 -1.2">
  <a-plane id="btnPrev"  class="clickable" width="1" height="0.8"></a-plane>
  <a-plane id="btnEnter" class="clickable" width="1" height="0.9"></a-plane>
  <a-plane id="btnNext"  class="clickable" width="1" height="0.8"></a-plane>
 </a-entity>

</a-scene>

<!-- ================================================================================= -->
<!-- VR CONTROLLER ‚Üí CLICK UI EVENTS  (THIS IS THE MAGIC YOU ASKED)                    -->
<!-- ================================================================================= -->

<script>
AFRAME.registerComponent('ui-click-forwarder',{
 init(){
  this.el.addEventListener('click',()=>this.forward())
 },
 forward(){
  document.elementFromPoint(window.innerWidth/2,window.innerHeight/2)?.click();
 }
});

document.querySelector("#rightHand").setAttribute("ui-click-forwarder","");
document.querySelector("#leftHand").setAttribute("ui-click-forwarder","");
</script>

<script src="tour.js"></script>
</body>
</html>
